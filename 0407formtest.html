<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2중셀렉트박스</title>

  <style>
    #phone {
      width: 1000px !important;
      position: absolute;
      z-index: 15;
    }
    .precolour,
    #Preview {
      display: inline-block;
    }
    #Preview {
      position: absolute;
      width: 1000px !important;
    }
    .pretest {
      display: inline-block;
    }
    .pretest div {
      margin-bottom: 2vh;
      display: inline-block;
    }
    #option1 {
      z-index: 5;
    }
    #logo {
      position: absolute;
      width: auto !important;   
      top: 50%;
      left: 50%;
      height: 137%;
      transform: rotate(-61deg) rotateY(30deg) skew(0deg, 16deg) translate(-50%, -50%);   
      z-index: 10;
    }
    .logoposition {
      /* position: relative; */
      position: absolute;
      top: 334px;
      left: 250px;
      width: 244px;
      height: 152px;
      display: block;
      perspective : 5000px ;
    }
    #card1,
    #card2 {
      width: 100px !important;
    }
    /* #fileInput {
      opacity: 0;
    } */
    #optionN {
      opacity: 1;
    }
  </style>
</head>
<body>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <section class="scroll-section" id="scroll-section-0" style="height: 2500px;">

    <section class = "pre">
      <div id="Preview">
          <div><img id='phone' src="https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/cardblanck.png" style="left: 0;"></img></div>  <!--핸드폰사진-->
          <div><img id='option1' src="" style="width: 1000px;"></img></div>
          <div class="logoposition" style="margin-left: 0px; margin-right: 0px;">
            <img src="" id="logo"> <!--카드 들어갈 자리-->
          </div>
        </div>

        <!--카드 미리보기-->
        <div class="precolour" style="margin-left:1100px;">

          <!-- <select id="optionN" name="optionN" style="margin-top: 100px;">
            <option value="" selected hidden disabled>[카드]</option>
            <option value="ahrwnf" id="ahrwnf">현대카드</option>
            <option value="dnjsgud" id="dnjsgud">신한카드</option>
          </select>
          </select><br> <br> -->
          <select id="mainCategory" name="mainCategory" style="margin-top: 100px;">
            <option value="" selected hidden disabled>[카드]</option>
          </select>
          <select id="subCategory" name="subCategory" style="margin-top: 100px;">
              <option value="" selected hidden disabled>[카테고리]</option>
          </select>

          <!--카드 2개-->
          <div class = "pretest">
          <div id="colour"><img id="card1" src="https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/whitecardsize.png" width='100'></img></div>
          <div id="colour1"><img id="card2" src="https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/whitecardsize.png" width='100'></img></div>
          </div><br>

          <!-- 카드 선택 -->
          <input id="fileInput" name="fileInput" type="file" class="fileInput"  accept="image/*"  value="Resize Image"  />  
          <!-- onclick="file()" -->
        </div>
    </section>
  </section>

  <script>
    //카드 사진 사이즈 조절
    $(document).ready(function() {
    $('#fileInput').change(function(evt) {    //evt : event 축약어
      $('#option1').css('opacity', '0');
      $('#logo').css('opacity', '1');
        var files = evt.target.files;
        var file = files[0];

        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('logo').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });
  });

  //옵션 목록별로 다른 이미지로 변경 
      //여기 if조건문으로 현대카드 / 신한카드 일 때로 구분하기 ******
    //현대카드
    function Hyundai() {
      document.getElementById('card1').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/Hyundai/purple.png";
      document.getElementById('card2').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/Hyundai/red.png";
    }
    function colour1() {
      $('#logo').css('opacity', '0');
      $('#option1').css('opacity', '1');
      document.getElementById('option1').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/purple.png";
      };
    function colour1_1() {    
      $('#logo').css('opacity', '0');
      $('#option1').css('opacity', '1');
      document.getElementById('option1').src = 'https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/red.png'; 
      };
    //신한카드
    function Shinhan() {
      document.getElementById('card1').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/Shinhan/minian.png";
      document.getElementById('card2').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/Shinhan/mintcard.png";
    }
    function colour2() {
      $('#logo').css('opacity', '0');
      $('#option1').css('opacity', '1');
      document.getElementById('option1').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/minian.png";
      };
    function colour2_1() {
      $('#logo').css('opacity', '0');
      $('#option1').css('opacity', '1');
      document.getElementById('option1').src = "https://framebystore.cafe24.com/sujin_code_test/images/cardcustom/mintcard.png";
      };

    //여기 if조건문으로 현대카드 / 신한카드 일 때로 구분하기 *******
    $('#subCategory').change(function() {
      var state = $('#subCategory option:selected').val();
      console.log(state);
      if ( state == '1' ) {
        Hyundai();
        document.getElementById('colour').onclick = function() {colour1()};
        document.getElementById('colour1').onclick = function() {colour1_1()};
      } else if (state == '2') {
        Shinhan();
        document.getElementById('colour').onclick = function() {colour2()};
        document.getElementById('colour1').onclick = function() {colour2_1()};
      };
    });

    //다중셀렉트
    $(document).ready(function() {
    
        var mainCategoryArray = new Array();
        var mainCategoryObject = new Object();
        
        mainCategoryObject = new Object();
        mainCategoryObject.main_category_id = "1";
        mainCategoryObject.main_category_name = "현대카드";
        mainCategoryArray.push(mainCategoryObject);
        
        mainCategoryObject = new Object();
        mainCategoryObject.main_category_id = "2";
        mainCategoryObject.main_category_name = "신한카드";
        mainCategoryArray.push(mainCategoryObject);
        

        var subCategoryArray = new Array();
        var subCategoryObject = new Object();
        
        //현대카드에 해당하는 sub category 리스트
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "1";
        subCategoryObject.sub_category_id = "1"
        subCategoryObject.sub_category_name = "프리미엄"    
        subCategoryArray.push(subCategoryObject);
        
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "1";
        subCategoryObject.sub_category_id = "2"
        subCategoryObject.sub_category_name = "Z"    
        subCategoryArray.push(subCategoryObject);
        
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "1";
        subCategoryObject.sub_category_id = "3"
        subCategoryObject.sub_category_name = "포인트카드"    
        subCategoryArray.push(subCategoryObject);
        
        //신한카드에 해당하는 sub category 리스트
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "2";
        subCategoryObject.sub_category_id = "1"
        subCategoryObject.sub_category_name = "프리미엄"    
        subCategoryArray.push(subCategoryObject);
        
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "2";
        subCategoryObject.sub_category_id = "2"
        subCategoryObject.sub_category_name = "신용카드"    
        subCategoryArray.push(subCategoryObject);
        
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "2";
        subCategoryObject.sub_category_id = "3"
        subCategoryObject.sub_category_name = "제휴카드"    
        subCategoryArray.push(subCategoryObject);
        
        subCategoryObject = new Object();
        subCategoryObject.main_category_id = "2";
        subCategoryObject.sub_category_id = "4"
        subCategoryObject.sub_category_name = "디자인카드"    
        subCategoryArray.push(subCategoryObject);
        //****************이부분은 DB로 셋팅하세요.
        
        
        //메인 카테고리 셋팅
        var mainCategorySelectBox = $("select[name='mainCategory']");
        
        for(var i=0;i<mainCategoryArray.length;i++){
            mainCategorySelectBox.append("<option value='"+mainCategoryArray[i].main_category_id+"'>"+mainCategoryArray[i].main_category_name+"</option>");
        }
        console.log(mainCategorySelectBox);
        
        //*********** 1depth카테고리 선택 후 2depth 생성 START ***********
        $(document).on("change","select[name='mainCategory']",function(){
            
            //두번째 셀렉트 박스를 삭제 시킨다.
            var subCategorySelectBox = $("select[name='subCategory']");
            subCategorySelectBox.children().remove(); //기존 리스트 삭제
            
            //선택한 첫번째 박스의 값을 가져와 일치하는 값을 두번째 셀렉트 박스에 넣는다.
            $("option:selected", this).each(function(){
                var selectValue = $(this).val(); //main category 에서 선택한 값
                console.log(selectValue);
                subCategorySelectBox.append("<option value=''>전체</option>");
                for(var i=0;i<subCategoryArray.length;i++){
                    if(selectValue == subCategoryArray[i].main_category_id){
                        
                        subCategorySelectBox.append("<option value='"+subCategoryArray[i].sub_category_id+"'>"+subCategoryArray[i].sub_category_name+"</option>");
                        
                    }
                }
            });
            
        });
    });
  </script>
</body>
</html>